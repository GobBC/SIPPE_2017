<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptProyectoActividadRamo" language="groovy" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a89524e2-618a-4b8b-b71b-7d8c1e4ca7a8">
	<property name="ireport.zoom" value="1.6105100000000014"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="YEAR_CAPTURA" class="java.lang.Integer"/>
	<parameter name="IN_CAPSULE" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="QUERY" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
    DISTINCT RAMPRG.RAMO,
    RAM.DESCR RAMO_DESCR,
    PROY.PROY,
    PROY.TIPO_PROY,
    PROY.DEPTO,
    VWSPPROYACT.DESCR PROYECTO_DESCR,
    PARAM.GOBIERNO,
    PARAM.SECRETARIA,
    SYSDATE AS HOY

FROM
    POA.RAMO_PROGRAMA RAMPRG,
    DGI.RAMOS RAM,
    S_POA_PROGRAMA PRG,
    POA.PROYECTO PROY,
    DGI.PARAMETROS PARAM,
    DGI.VW_SP_PROY_ACT VWSPPROYACT

WHERE
    ( RAMPRG.YEAR = $P{YEAR_CAPTURA} )	AND
    ( RAM.RAMO = RAMPRG.RAMO   ) AND
    ( RAM.YEAR = RAMPRG.YEAR ) AND
    ( PRG.YEAR = RAMPRG.YEAR ) AND
    ( PRG.PRG = RAMPRG.PRG ) AND
    ( PROY.RAMO(+) = RAMPRG.RAMO ) AND
    ( PROY.YEAR = RAMPRG.YEAR ) AND
    ( PROY.PRG(+) = RAMPRG.PRG ) AND
    ( PROY.TIPO_PROY  IN($P!{IN_CAPSULE}) OR PROY.TIPO_PROY IS NULL) AND
    ( VWSPPROYACT.TIPO_PROY = PROY.TIPO_PROY ) AND
    ( VWSPPROYACT.PROY = PROY.PROY ) AND
    ( VWSPPROYACT.YEAR = PROY.YEAR )
$P!{QUERY}]]>
	</queryString>
	<field name="RAMO" class="java.lang.String"/>
	<field name="RAMO_DESCR" class="java.lang.String"/>
	<field name="PROY" class="java.math.BigDecimal"/>
	<field name="TIPO_PROY" class="java.lang.String"/>
	<field name="DEPTO" class="java.lang.String"/>
	<field name="PROYECTO_DESCR" class="java.lang.String"/>
	<field name="GOBIERNO" class="java.lang.String"/>
	<field name="SECRETARIA" class="java.lang.String"/>
	<field name="HOY" class="java.sql.Timestamp"/>
	<variable name="PROY_SUM" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PROY}]]></variableExpression>
	</variable>
	<group name="ramo" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{RAMO}]]></groupExpression>
		<groupHeader>
			<band height="17">
				<textField isBlankWhenNull="true">
					<reportElement uuid="34b2d1c3-8280-4b6c-9f57-2503fa4848f8" x="0" y="0" width="717" height="15"/>
					<textElement>
						<font fontName="SansSerif" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{RAMO} + "-" + $F{RAMO_DESCR}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="ProyectoActividad">
		<groupExpression><![CDATA[$F{TIPO_PROY}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band height="15">
				<textField>
					<reportElement uuid="fec4e91e-5696-42f3-956e-cedb77e98297" x="1" y="0" width="286" height="15"/>
					<textElement>
						<font fontName="SansSerif" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{TIPO_PROY} == "A"?
    "Total de Actividades para el Ramo " + $F{RAMO}+ ": " + $V{ProyectoActividad_COUNT} :
     $F{TIPO_PROY} == "P"?
        "Total de Proyectos para el Ramo " + $F{RAMO}+ ": " + $V{ProyectoActividad_COUNT}  :
        ""]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="TIPO_PROY">
		<groupExpression><![CDATA[$F{TIPO_PROY}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="105">
			<textField>
				<reportElement uuid="8b1bb6f8-6a1b-4a59-94be-d8200204cb77" x="164" y="40" width="429" height="20"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression><![CDATA[$P{IN_CAPSULE} == "'A','P'"?
    "REPORTE DE PROYECTOS / ACTIVIDADES POR RAMO AL " + $P{YEAR_CAPTURA} :
    $P{IN_CAPSULE} == "'A'"?
        "REPORTE DE ACTIVIDADES POR RAMO AL " + $P{YEAR_CAPTURA} :
        $P{IN_CAPSULE} == "'P'"?
            "REPORTE DE PROYECTOS POR RAMO AL " + $P{YEAR_CAPTURA} :
            ""]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="a60bf77f-b837-4a2a-8e77-b073092824e4" x="164" y="20" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SECRETARIA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="72e73dbb-b75d-4df7-b449-ddc672b9594c" x="164" y="0" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GOBIERNO}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="83ac839b-41bc-48e4-afac-3ceaa5da70c9" x="1" y="73" width="35" height="15"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Ramo]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="e5292e70-8c1a-46f2-bea9-a544113de9b5" x="24" y="88" width="89" height="15"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Proyecto / Actividad]]></text>
			</staticText>
			<line>
				<reportElement uuid="a2b49ed5-afef-4a3d-81fb-35c8028c9c57" x="1" y="102" width="751" height="1"/>
			</line>
			<image hAlign="Center" vAlign="Middle">
				<reportElement uuid="b3794f33-5b78-44f0-8b77-0c66e770002e" stretchType="RelativeToBandHeight" x="0" y="1" width="66" height="59"/>
				<imageExpression><![CDATA[$P{IMG_DIR}+"EDO.gif"]]></imageExpression>
			</image>
		</band>
	</pageHeader>
	<detail>
		<band height="15">
			<textField isBlankWhenNull="true">
				<reportElement uuid="91b0adc3-f006-4c40-8cb4-484b549a3445" x="24" y="0" width="705" height="15"/>
				<textElement>
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PROY} + "" + $F{TIPO_PROY} + "-" + $F{PROYECTO_DESCR}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="12" splitType="Stretch">
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="9f193cbf-f4f6-4fec-ae9f-da433084666f" x="300" y="1" width="146" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{HOY}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="55657e43-4a2a-4cea-977c-eaf1a221401a" x="0" y="0" width="752" height="1"/>
			</line>
			<textField>
				<reportElement uuid="0a693d0b-5a53-41dc-ab79-ca7e70f4735b" x="677" y="0" width="43" height="10"/>
				<textElement textAlignment="Right">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["PÃ¡gina "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="96caeec8-1aba-4a91-95d9-2ad6915df398" x="720" y="0" width="31" height="10"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[" de " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="7243b8bc-9ff9-4abb-addb-cb320a263333" x="0" y="1" width="146" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["rptProyectoActividadRamo"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
