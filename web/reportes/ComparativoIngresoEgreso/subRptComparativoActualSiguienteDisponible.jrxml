<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="subRptComparativoActualSiguienteDisponible" language="groovy" pageWidth="752" pageHeight="20" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="752" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="66532bb3-f8a2-463f-9d8f-70f5ad6f04bf">
	<property name="ireport.zoom" value="0.75"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Porcentaje1">
		<conditionalStyle>
			<conditionExpression><![CDATA[($F{PRESUPSIG} - $F{PRESUP_MODIFICADO}) >= 0]]></conditionExpression>
			<style forecolor="#000000" pattern=""/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[($F{PRESUPSIG} - $F{PRESUP_MODIFICADO}) < 0]]></conditionExpression>
			<style forecolor="#FF0000" pattern="">
				<pen lineColor="#000000"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineColor="#000000"/>
					<leftPen lineColor="#000000"/>
					<bottomPen lineColor="#000000"/>
					<rightPen lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
	</style>
	<style name="Inicial">
		<conditionalStyle>
			<conditionExpression><![CDATA[$F{ASIGNADO} >= 0]]></conditionExpression>
			<style forecolor="#000000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$F{ASIGNADO} < 0]]></conditionExpression>
			<style forecolor="#FF0000">
				<pen lineColor="#000000"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineColor="#000000"/>
					<leftPen lineColor="#000000"/>
					<bottomPen lineColor="#000000"/>
					<rightPen lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
	</style>
	<style name="Asignado">
		<conditionalStyle>
			<conditionExpression><![CDATA[$F{PRESUP_MODIFICADO} >= 0]]></conditionExpression>
			<style forecolor="#000000">
				<pen lineColor="#000000"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineColor="#000000"/>
					<leftPen lineColor="#000000"/>
					<bottomPen lineColor="#000000"/>
					<rightPen lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$F{PRESUP_MODIFICADO} < 0]]></conditionExpression>
			<style forecolor="#FF0000">
				<pen lineColor="#000000"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineColor="#000000"/>
					<leftPen lineColor="#000000"/>
					<bottomPen lineColor="#000000"/>
					<rightPen lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
	</style>
	<style name="Presupuestado">
		<conditionalStyle>
			<conditionExpression><![CDATA[$F{PRESUPSIG} >= 0]]></conditionExpression>
			<style forecolor="#000000">
				<pen lineColor="#000000"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineColor="#000000"/>
					<leftPen lineColor="#000000"/>
					<bottomPen lineColor="#000000"/>
					<rightPen lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$F{PRESUPSIG} < 0]]></conditionExpression>
			<style forecolor="#FF0000">
				<pen lineColor="#000000"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineColor="#000000"/>
					<leftPen lineColor="#000000"/>
					<bottomPen lineColor="#000000"/>
					<rightPen lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
	</style>
	<parameter name="YEAR_SIG" class="java.lang.String"/>
	<parameter name="RAMO" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
	NVL(PPTO_ING_CAPTURA.PRESUP_ASIGNADO,0) AS ASIGNADO,
	NVL(PPTO_ING_CAPTURA.MODIFICADO,0) AS PRESUP_MODIFICADO,
	NVL(PPTO_ING.PRESUP,0) AS PRESUPSIG

FROM

	(
		SELECT
			SUM(NVL(PIC.ASIGNADO,0)) AS PRESUP_ASIGNADO,
			SUM(NVL(PIC.PRESUP_MODIFICADO,0)) AS MODIFICADO
		FROM
			(
				SELECT
					PPING.YEAR,
					PPING.RAMO,
					PPING.RUBRO,
					SUM(NVL(PPING.ASIGNADO,0)) ASIGNADO,
					SUM(NVL(PPING.PRESUP_MODIFICADO,0)) PRESUP_MODIFICADO
				FROM
					S_POA_PPTO_ING_CAPTURA_ANT PPING
				GROUP BY
					PPING.YEAR,
					PPING.RAMO,
					PPING.RUBRO

				UNION

				SELECT
					PPING.YEAR,
					PPING.RAMO,
					PPING.RUBRO,
					SUM(NVL(PPING.ASIGNADO,0)) ASIGNADO,
					SUM(NVL(PPING.ASIGNADO,0)) + SUM(NVL(PPING.AMPLIACIONES,0)) - SUM(NVL(PPING.REDUCCIONES,0)) PRESUP_MODIFICADO
				FROM
					(
						SELECT
							PPI.YEAR,
							PPI.RAMO,
							PCL.RUBRO,
							SUM(NVL(PPI.ENE,0)+NVL(PPI.FEB,0)+NVL(PPI.MZO,0)+NVL(PPI.ABR,0)+NVL(PPI.MAY,0)+NVL(PPI.JUN,0)+NVL(PPI.JUL,0)+NVL(PPI.AGO,0)+NVL(PPI.SEP,0)+NVL(PPI.OCT,0)+NVL(PPI.NOV,0)+NVL(PPI.DIC,0)) AS ASIGNADO,
							0 AMPLIACIONES,
							0 REDUCCIONES
						FROM
							DGI.POA_PPTO_ING PPI,
							S_ING_CONCEP PCL
						WHERE
							PPI.CONCEPTO=PCL.CONCEPTO AND
							PCL.EJERCICIO = $P{YEAR_SIG}
						GROUP BY
							PPI.YEAR,
							PPI.RAMO,
							PCL.RUBRO

						UNION ALL

						SELECT
							PPI.YEAR,
							PPI.RAMO,
							PCL.RUBRO,
							0 AS ASIGNADO,
							CASE PPI.TIPOMOV WHEN 'A' THEN SUM(NVL(PPI.ENE,0)+NVL(PPI.FEB,0)+NVL(PPI.MZO,0)+NVL(PPI.ABR,0)+NVL(PPI.MAY,0)+NVL(PPI.JUN,0)+NVL(PPI.JUL,0)+NVL(PPI.AGO,0)+NVL(PPI.SEP,0)+NVL(PPI.OCT,0)+NVL(PPI.NOV,0)+NVL(PPI.DIC,0)) ELSE 0 END AMPLIACIONES,
							CASE PPI.TIPOMOV WHEN 'R' THEN SUM(NVL(PPI.ENE,0)+NVL(PPI.FEB,0)+NVL(PPI.MZO,0)+NVL(PPI.ABR,0)+NVL(PPI.MAY,0)+NVL(PPI.JUN,0)+NVL(PPI.JUL,0)+NVL(PPI.AGO,0)+NVL(PPI.SEP,0)+NVL(PPI.OCT,0)+NVL(PPI.NOV,0)+NVL(PPI.DIC,0)) ELSE 0 END REDUCCIONES
						FROM
							POA.CARATULA_PPTO_ING PPI,
							S_ING_CONCEP PCL
						WHERE
							PPI.CONCEPTO=PCL.CONCEPTO AND
							PCL.EJERCICIO = $P{YEAR_SIG}
						GROUP BY
							PPI.YEAR,
							PPI.RAMO,
							PCL.RUBRO,
							PPI.TIPOMOV
					) PPING
				GROUP BY
					PPING.YEAR,
					PPING.RAMO,
					PPING.RUBRO
			) PIC
		WHERE
			PIC.RAMO = $P{RAMO} AND
			PIC.YEAR = $P{YEAR_SIG}
	) PPTO_ING_CAPTURA,
	(
		SELECT
			SUM(NVL(PPI.ENE,0)+NVL(PPI.FEB,0)+NVL(PPI.MZO,0)+NVL(PPI.ABR,0)+NVL(PPI.MAY,0)+NVL(PPI.JUN,0)+NVL(PPI.JUL,0)+NVL(PPI.AGO,0)+NVL(PPI.SEP,0)+NVL(PPI.OCT,0)+NVL(PPI.NOV,0)+NVL(PPI.DIC,0)) AS PRESUP
		FROM
			DGI.POA_PPTO_ING PPI
		WHERE
			PPI.RAMO=$P{RAMO} AND
			PPI.YEAR=TO_CHAR(TO_NUMBER($P{YEAR_SIG})+1)
	) PPTO_ING
GROUP BY
	NVL(PPTO_ING_CAPTURA.PRESUP_ASIGNADO,0),
	NVL(PPTO_ING_CAPTURA.MODIFICADO,0),
	NVL(PPTO_ING.PRESUP,0)]]>
	</queryString>
	<field name="ASIGNADO" class="java.math.BigDecimal"/>
	<field name="PRESUP_MODIFICADO" class="java.math.BigDecimal"/>
	<field name="PRESUPSIG" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<detail>
		<band height="20" splitType="Stretch">
			<textField pattern="¤ #,##0.00;(¤ #,##0.00)" isBlankWhenNull="true">
				<reportElement uuid="9e3ba1dd-db0d-4dc1-97bc-a378e3f0109d" style="Presupuestado" x="454" y="0" width="120" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRESUPSIG}]]></textFieldExpression>
			</textField>
			<textField pattern="¤ #,##0.00;(¤ #,##0.00)" isBlankWhenNull="true">
				<reportElement uuid="86b91a15-cc27-4b4d-9395-253240679574" style="Inicial" x="238" y="0" width="116" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ASIGNADO}]]></textFieldExpression>
			</textField>
			<textField pattern="¤ #,##0.00;(¤ #,##0.00)" isBlankWhenNull="true">
				<reportElement uuid="6ee976c2-bda4-4bac-83d8-daf87c8eafb7" style="Asignado" x="354" y="0" width="100" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRESUP_MODIFICADO}]]></textFieldExpression>
			</textField>
			<textField pattern="¤ #,##0.00;(¤ #,##0.00)" isBlankWhenNull="true">
				<reportElement uuid="50fb42f1-fe40-41d8-8742-1e05b672e7b0" style="Porcentaje1" x="574" y="0" width="122" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRESUPSIG} - $F{PRESUP_MODIFICADO}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00 %;(#,##0.00 %)" isBlankWhenNull="true">
				<reportElement uuid="82c6aa69-b771-478d-a546-47d2bd9e7594" style="Porcentaje1" x="696" y="0" width="56" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRESUP_MODIFICADO} == 0 ? "0 %" : ($F{PRESUPSIG}-$F{PRESUP_MODIFICADO})/$F{PRESUP_MODIFICADO}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="90c7c19f-59d4-420a-b050-38b7d318caa4" x="0" y="0" width="238" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[DISPONIBILIDAD]]></text>
			</staticText>
		</band>
	</detail>
</jasperReport>
