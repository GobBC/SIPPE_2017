<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptPptoRamGpo" language="groovy" pageWidth="612" pageHeight="792" columnWidth="592" leftMargin="10" rightMargin="10" topMargin="10" bottomMargin="10" uuid="b7175885-fd37-4424-b6d0-29ca3b3df42a">
	<property name="ireport.zoom" value="1.464100000000021"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="YEAR" class="java.lang.Integer"/>
	<parameter name="RAMO_IN_LIST" class="java.lang.String">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\desarrollo\\repositorio_local\\POA\\web\\reportes\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="QUERY" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="MODACT" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
	PPTO.YEAR,
	PPTO.RAMO,
	R.DESCR AS RAMO_DESCR,
	G.GRUPO,
	G.DESCR GRUPO_DESCR,
	--SUM(PPTO.ASIGNADO) AS ASIGNADO
	SUM(PPTO.ENEACT + PPTO.FEBACT + PPTO.MARACT + PPTO.ABRACT + PPTO.MAYACT + PPTO.JUNACT + PPTO.JULACT + PPTO.AGOACT + PPTO.SEPACT + PPTO.OCTACT + PPTO.NOVACT +PPTO.DICACT) AS ASIGNADO,
	PRAM.GOBIERNO,
	PRAM.SECRETARIA,
	SYSDATE AS FECHA

FROM
	SPP.VW_PRESUP_ASIG_MEN PPTO,
	DGI.RAMOS R,
	DGI.PARTIDA PART,
	S_DGI_GRUPOS G,
	S_DGI_SUBGRUPOS SG,
	S_DGI_SUBSUBGPO SSG,
	DGI.PARAMETROS PRAM

WHERE
	PPTO.YEAR = $P{YEAR} AND
	PPTO.RAMO IN($P!{RAMO_IN_LIST}) AND
	$P!{QUERY}
	R.YEAR = PPTO.YEAR AND
	R.RAMO = PPTO.RAMO AND
	PART.YEAR = PPTO.YEAR AND
	PART.PARTIDA = PPTO.PARTIDA AND
	SSG.YEAR = PART.YEAR AND
	SSG.SUBSUBGRUPO = PART.SUBSUBGPO AND
	SG.YEAR = SSG.YEAR AND
	SG.SUBGRUPO = SSG.SUBGRUPO AND
	G.YEAR = SG.YEAR AND
	G.GRUPO = SG.GRUPO

GROUP BY
	PPTO.YEAR,
	PPTO.RAMO,
	R.DESCR,
	G.GRUPO,
	G.DESCR,
	PRAM.GOBIERNO,
	PRAM.SECRETARIA,
	SYSDATE

ORDER BY
	PPTO.YEAR,
	PPTO.RAMO,
	R.DESCR,
	G.GRUPO,
	G.DESCR,
   	PRAM.GOBIERNO,
	PRAM.SECRETARIA,
	SYSDATE]]>
	</queryString>
	<field name="YEAR" class="java.lang.String"/>
	<field name="RAMO" class="java.lang.String"/>
	<field name="RAMO_DESCR" class="java.lang.String"/>
	<field name="GRUPO" class="java.lang.String"/>
	<field name="GRUPO_DESCR" class="java.lang.String"/>
	<field name="ASIGNADO" class="java.math.BigDecimal"/>
	<field name="GOBIERNO" class="java.lang.String"/>
	<field name="SECRETARIA" class="java.lang.String"/>
	<field name="FECHA" class="java.sql.Timestamp"/>
	<variable name="RamoAsignado" class="java.math.BigDecimal" resetType="Group" resetGroup="RAMO" calculation="Sum">
		<variableExpression><![CDATA[$F{ASIGNADO}]]></variableExpression>
		<initialValueExpression><![CDATA[BigDecimal.valueOf(0)]]></initialValueExpression>
	</variable>
	<variable name="GeneralAsignado" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ASIGNADO}]]></variableExpression>
		<initialValueExpression><![CDATA[BigDecimal.valueOf(0)]]></initialValueExpression>
	</variable>
	<group name="RAMO">
		<groupExpression><![CDATA[$F{RAMO}]]></groupExpression>
		<groupHeader>
			<band height="12">
				<textField isBlankWhenNull="true">
					<reportElement uuid="97011c3a-3706-4161-ba6a-9c3b788c092e" x="0" y="0" width="592" height="12"/>
					<textElement verticalAlignment="Top" markup="none">
						<font fontName="SansSerif" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{RAMO}+" "+$F{RAMO_DESCR}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="12">
				<printWhenExpression><![CDATA[$V{RamoAsignado} > 0]]></printWhenExpression>
				<textField isBlankWhenNull="true">
					<reportElement uuid="b13bdb5e-3ce4-4c5b-8d00-866618090847" x="317" y="0" width="167" height="12"/>
					<textElement verticalAlignment="Top" markup="none">
						<font fontName="SansSerif" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Total Por Ramo "]]></textFieldExpression>
				</textField>
				<textField pattern="¤ #,##0.00" isBlankWhenNull="true">
					<reportElement uuid="b527c25b-7081-4155-a908-a5e78a0dbaad" x="484" y="0" width="108" height="12"/>
					<textElement textAlignment="Right" verticalAlignment="Top" markup="none">
						<font fontName="SansSerif" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{RamoAsignado}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="87">
			<line>
				<reportElement uuid="1d3be814-588d-4f2c-973f-13545b01ff28" x="0" y="86" width="592" height="1"/>
			</line>
			<textField isBlankWhenNull="true">
				<reportElement uuid="193ae223-68ce-4eaa-9c20-d2124762461e" x="65" y="0" width="462" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GOBIERNO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="82d8947e-094c-49bc-a69a-d66b7509c3e3" x="65" y="18" width="462" height="16"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SECRETARIA}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="5c259b52-9a61-4e75-883f-ec887db2686c" x="65" y="34" width="462" height="14"/>
				<textElement textAlignment="Center" verticalAlignment="Top" markup="none">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{MODACT}.equals("ACT") ? "PRESUPUESTO MODIFICADO ANUAL" : "PRESUPUESTO ASIGNADO ANUAL"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="f21f9617-7bdc-4edd-864f-0630eccf050d" x="0" y="62" width="532" height="12"/>
				<textElement verticalAlignment="Top">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Ramo]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="5b4ac66c-64fc-4f5c-addb-c1683780070a" x="65" y="48" width="462" height="14"/>
				<textElement textAlignment="Center" verticalAlignment="Top" markup="none">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["RAMO - CAPÍTULO "+ $P{YEAR}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="de5bb955-640f-4d08-9f59-1209b81d6d2b" x="484" y="74" width="108" height="12"/>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="1f3d595f-1132-4634-8d97-fd7b2fe22f81" x="14" y="74" width="470" height="12"/>
				<textElement verticalAlignment="Top">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Capítulo]]></text>
			</staticText>
			<image>
				<reportElement uuid="ca7a0576-842c-49e5-87cd-1841048f9c87" x="0" y="0" width="65" height="59"/>
				<imageExpression><![CDATA[$P{IMG_DIR} + "EDO.gif"]]></imageExpression>
			</image>
		</band>
	</pageHeader>
	<detail>
		<band height="12" splitType="Stretch">
			<printWhenExpression><![CDATA[$F{ASIGNADO} > 0]]></printWhenExpression>
			<textField isBlankWhenNull="true">
				<reportElement uuid="cc454cc9-8da3-4c46-a4cc-aa84c96e24d6" x="14" y="0" width="470" height="12"/>
				<textElement verticalAlignment="Top" markup="none">
					<font fontName="SansSerif" size="8" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GRUPO}+" "+$F{GRUPO_DESCR}]]></textFieldExpression>
			</textField>
			<textField pattern="¤ #,##0.00" isBlankWhenNull="true">
				<reportElement uuid="d8d79959-1c31-4c59-927c-169b9cd5f07a" x="484" y="0" width="108" height="12"/>
				<textElement textAlignment="Right" verticalAlignment="Top" markup="none">
					<font fontName="SansSerif" size="8" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ASIGNADO}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="11" splitType="Stretch">
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="1e825092-9443-4d79-8296-59c51232005f" x="0" y="1" width="592" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FECHA}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="8f3086f4-326e-4acd-9aa2-a78411f2665e" x="0" y="0" width="592" height="1"/>
			</line>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="769e604e-48f1-4b4e-bc1d-e4c9361618b3" x="0" y="1" width="109" height="10"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["<rptPptoRamGpo>"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="d3449b5a-9bdc-4adb-b877-b2d5e72e1eab" x="484" y="0" width="68" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="1aa76a9f-07e6-4c9d-9e45-e7799a7b3d8c" x="552" y="0" width="40" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="12" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement uuid="1dd5b60b-bf0f-4133-b2e5-80fa258ae28e" x="317" y="0" width="167" height="12"/>
				<textElement verticalAlignment="Top" markup="none">
					<font fontName="SansSerif" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Total General"]]></textFieldExpression>
			</textField>
			<textField pattern="¤ #,##0.00" isBlankWhenNull="true">
				<reportElement uuid="afdbca4f-d50d-4dfb-a94a-674d5cafec22" x="484" y="0" width="108" height="12"/>
				<textElement textAlignment="Right" verticalAlignment="Top" markup="none">
					<font fontName="SansSerif" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{GeneralAsignado}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
