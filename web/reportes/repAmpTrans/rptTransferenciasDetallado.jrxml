<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptTransferenciasDetallado" language="groovy" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isSummaryWithPageHeaderAndFooter="true" uuid="d08c2163-aa59-4226-a299-145bee118e5f">
	<property name="ireport.zoom" value="1.6105100000000023"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Table Dataset 1" uuid="f35a429f-5fca-46f3-9a38-51cb2470a5e1"/>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="OFICIO" class="java.lang.Long"/>
	<parameter name="TIPO" class="java.lang.String"/>
	<parameter name="YEAR" class="java.lang.String"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="ESTATUS" class="java.lang.String"/>
	<parameter name="RPT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["C:\\desarrollo\\repositorio_local\\POA_13042016\\trunk\\POA\\web\\reportes\\repAmpTrans\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="TIPOFICIO" class="java.lang.String"/>
	<parameter name="CODIGOCOMPLETO" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT

         PARAM.GOBIERNO,
         PARAM.SECRETARIA,

        TRAN.STATUS,
         MOVS.FECPPTO  ,
			PARAM.LOGO,
	DBMS_LOB.substr(MOVS.JUSTIFICACION, DBMS_LOB.getlength(MOVS.JUSTIFICACION), 1) as JUSTIFICACION

    FROM DGI.OFICONS OFI,
         SPP.TRANSFERENCIAS TRAN,
         SPP.TRANSFREC REC,
         DGI.PARTIDA PARTIDA_A,
         DGI.PARTIDA PARTIDA_B,
         DGI.PARAMETROS PARAM,
         POA.MOVOFICIOS MOVS,
	S_DGI_PARAM_LONG_COD PLC
   WHERE (TRAN.OFICIO = OFI.OFICIO ) and
         ( REC.OFICIO =TRAN.OFICIO ) and
         ( REC.CONSEC =TRAN.CONSEC ) and
         (TRAN.PARTIDA = PARTIDA_A.PARTIDA ) and
         ( REC.PARTIDA = PARTIDA_B.PARTIDA ) and
         ( OFI.CONSEC =TRAN.CONSEC ) and
         (TRAN.OFICIO = MOVS.OFICIO ) and
         ( PARTIDA_A.YEAR = PARTIDA_B.YEAR ) and
         ( ( OFI.OFICIO = $P{OFICIO} ) AND
         ( OFI.TIPO = $P{TIPOFICIO} )) AND
         PARTIDA_A.YEAR = $P{YEAR} AND
	PLC.YEAR = PARTIDA_A.YEAR AND
      (LENGTH(NVL($P{TIPOFICIO},'00'))=1)
    GROUP BY

         PARAM.GOBIERNO,
         PARAM.SECRETARIA,
        TRAN.STATUS,
         MOVS.FECPPTO  ,
			PARAM.LOGO,
	DBMS_LOB.substr(MOVS.JUSTIFICACION, DBMS_LOB.getlength(MOVS.JUSTIFICACION), 1)

UNION

SELECT

         PARAM.GOBIERNO,
         PARAM.SECRETARIA,

        TRAN.STATUS,
         MOVS.FECPPTO  ,
			PARAM.LOGO,
	DBMS_LOB.substr(MOVS.JUSTIFICACION, DBMS_LOB.getlength(MOVS.JUSTIFICACION), 1) as JUSTIFICACION

    FROM
         SPP.TRANSFERENCIAS TRAN,
         SPP.TRANSFREC REC,
         DGI.PARTIDA PARTIDA_A,
         DGI.PARTIDA PARTIDA_B,
         DGI.PARAMETROS PARAM,
         POA.MOVOFICIOS MOVS,
	S_DGI_PARAM_LONG_COD PLC
   WHERE
         ( REC.OFICIO =TRAN.OFICIO ) and
         ( REC.CONSEC =TRAN.CONSEC ) and
         (TRAN.PARTIDA = PARTIDA_A.PARTIDA ) and
         ( REC.PARTIDA = PARTIDA_B.PARTIDA ) and

         (TRAN.OFICIO = MOVS.OFICIO ) and
         ( PARTIDA_A.YEAR = PARTIDA_B.YEAR ) and
         MOVS.OFICIO=$P{OFICIO} AND
         PARTIDA_A.YEAR =$P{YEAR} AND
	PLC.YEAR = PARTIDA_A.YEAR AND
     (LENGTH(NVL($P{TIPOFICIO},'00'))>1)

    GROUP BY

         PARAM.GOBIERNO,
         PARAM.SECRETARIA,
        TRAN.STATUS,
         MOVS.FECPPTO  ,
			PARAM.LOGO,
	DBMS_LOB.substr(MOVS.JUSTIFICACION, DBMS_LOB.getlength(MOVS.JUSTIFICACION), 1)]]>
	</queryString>
	<field name="GOBIERNO" class="java.lang.String"/>
	<field name="SECRETARIA" class="java.lang.String"/>
	<field name="STATUS" class="java.lang.String"/>
	<field name="FECPPTO" class="java.sql.Timestamp"/>
	<field name="LOGO" class="java.lang.String"/>
	<field name="JUSTIFICACION" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="141">
			<textField>
				<reportElement uuid="78c2c8d1-f827-4cf8-96ca-fe2f225b94b2" x="175" y="0" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GOBIERNO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="5f5a910b-9768-44bf-99aa-6d087bb1b1d8" x="175" y="20" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SECRETARIA}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="3b651214-d8a4-4f8f-8268-693f81bc0d29" x="2" y="78" width="752" height="1"/>
			</line>
			<image hAlign="Center" vAlign="Middle">
				<reportElement uuid="58b6077c-f671-48f9-994e-61f8b829195c" stretchType="RelativeToBandHeight" x="0" y="0" width="67" height="56"/>
				<imageExpression><![CDATA[$P{IMG_DIR}+"EDO.gif"]]></imageExpression>
			</image>
			<elementGroup/>
			<elementGroup/>
			<elementGroup/>
			<elementGroup/>
			<elementGroup>
				<elementGroup/>
			</elementGroup>
			<elementGroup/>
			<elementGroup/>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="fffeb213-d7b3-455f-b091-f037bc24cfd8" x="654" y="56" width="100" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="1b5cb975-d6f8-46a0-a4dc-9cb5a02fe8c4" x="201" y="79" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{STATUS}.equals('C') || $F{STATUS}.equals('R') || $F{STATUS}.equals('M')
    ?"<FOLIO CANCELADO>":( $F{STATUS}.equals('A')? "<AUTORIZADO>": "<SIN AFECTACION A PRESUPUESTO>"))]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="eafbd61b-aa6b-4309-af77-4132be26ca03" x="11" y="79" width="59" height="20"/>
				<textElement markup="none">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[FOLIO #]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="609b5493-cf8f-4214-834d-3888c74e81da" x="11" y="99" width="59" height="20"/>
				<textElement markup="none">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHA:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="1980357b-687d-4f17-8d19-f6d17b21590f" x="70" y="99" width="79" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{FECPPTO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="f0db9971-4035-43ea-ab10-6c172805c7d5" x="70" y="79" width="79" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$P{OFICIO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3ec067d4-e995-4323-ad57-cb791a041e4e" x="11" y="119" width="151" height="20"/>
				<textElement>
					<font size="10" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{STATUS}.equals('C') || $F{STATUS}.equals('R') || $F{STATUS}.equals('M')
    ?"FECHA CANCELACIÓN:":( $F{STATUS}.equals('A')? "FECHA AUTORIZACIÓN:": ""))]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement uuid="775c1a2f-702a-4222-9c02-01007bc8336f" x="162" y="119" width="100" height="20">
					<printWhenExpression><![CDATA[($F{STATUS}.equals('C') || $F{STATUS}.equals('R') || $F{STATUS}.equals('M') || $F{STATUS}.equals('A'))]]></printWhenExpression>
				</reportElement>
				<subreportParameter name="OFICIO">
					<subreportParameterExpression><![CDATA[$P{OFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{RPT_DIR} + "rptAmpliacionesBitFechaAut.jasper"]]></subreportExpression>
			</subreport>
			<textField>
				<reportElement uuid="f526a934-925c-4fd6-95e7-46ab31a9cd99" x="175" y="40" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($P{TIPOFICIO}.equals('A')?"Solicitud de Autorización":($P{TIPOFICIO}.equals('V')?"Aviso de Modificación":($P{TIPOFICIO}.equals('U')?"Solicitud Movimientos Automaticos":"")))]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="1" splitType="Stretch">
			<subreport>
				<reportElement uuid="5df79323-7b62-4f25-9138-042de400cf82" x="0" y="0" width="749" height="0"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{RPT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="OFICIO">
					<subreportParameterExpression><![CDATA[$P{OFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="CODIGOCOMPLETO">
					<subreportParameterExpression><![CDATA[$P{CODIGOCOMPLETO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TIPO">
					<subreportParameterExpression><![CDATA[$P{TIPO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TIPOFICIO">
					<subreportParameterExpression><![CDATA[$P{TIPOFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ESTATUS">
					<subreportParameterExpression><![CDATA[$P{ESTATUS}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="YEAR">
					<subreportParameterExpression><![CDATA[$P{YEAR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="IMG_DIR">
					<subreportParameterExpression><![CDATA[$P{IMG_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="RPT_DIR">
					<subreportParameterExpression><![CDATA[$P{RPT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{RPT_DIR} + "rptTransferenciasDetalladoPresup1.jasper"]]></subreportExpression>
			</subreport>
		</band>
		<band height="1" splitType="Stretch">
			<subreport>
				<reportElement uuid="513ad465-c295-4de1-b717-9ab4c45a081f" x="0" y="0" width="752" height="0" isRemoveLineWhenBlank="true"/>
				<subreportParameter name="IMG_DIR">
					<subreportParameterExpression><![CDATA[$P{IMG_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="YEAR">
					<subreportParameterExpression><![CDATA[$P{YEAR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="OFICIO">
					<subreportParameterExpression><![CDATA[$P{OFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{RPT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ESTATUS">
					<subreportParameterExpression><![CDATA[$P{ESTATUS}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="RPT_DIR">
					<subreportParameterExpression><![CDATA[$P{RPT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TIPOFICIO">
					<subreportParameterExpression><![CDATA[$P{TIPOFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{RPT_DIR} + "rptMovtosProgramaticosTransferecias.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<pageFooter>
		<band height="18" splitType="Stretch">
			<line>
				<reportElement uuid="14384326-65ae-4666-91b9-2e968419c11a" x="1" y="2" width="752" height="1"/>
			</line>
			<textField evaluationTime="Report">
				<reportElement uuid="3b02f55a-e207-4cfa-8950-d2096a25a095" x="701" y="5" width="31" height="10"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[" de " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="8dbb6c57-25ff-4cac-aebe-f8eaa0af6c0f" x="658" y="5" width="43" height="10"/>
				<textElement textAlignment="Right">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="76c669b9-f019-41a6-ab9c-0777c5fec37e" x="1" y="5" width="146" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["rptTransferenciasDetallado"]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="f268e53d-217c-4286-a0e9-271659397c18" x="315" y="5" width="128" height="12"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="44" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement uuid="cbd6d350-2be0-4692-832f-e203ec779225" stretchType="RelativeToBandHeight" x="2" y="31" width="747" height="12" isRemoveLineWhenBlank="true"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{JUSTIFICACION}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="1aeba9b4-6cb0-48c8-9690-75fe182dfd1f" x="2" y="15" width="158" height="15"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Justificación:]]></text>
			</staticText>
			<line>
				<reportElement uuid="255c4136-b712-4f59-85f8-da75628c410e" x="2" y="30" width="752" height="1"/>
			</line>
		</band>
	</summary>
</jasperReport>
