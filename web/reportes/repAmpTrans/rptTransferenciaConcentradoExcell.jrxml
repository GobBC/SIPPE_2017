<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptTransferenciaConcentrado" language="groovy" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d08c2163-aa59-4226-a299-145bee118e5f">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="501"/>
	<property name="ireport.y" value="0"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Table Dataset 1" uuid="f35a429f-5fca-46f3-9a38-51cb2470a5e1"/>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="OFICIO" class="java.lang.String"/>
	<parameter name="TIPO" class="java.lang.String"/>
	<parameter name="YEAR" class="java.lang.String"/>
	<parameter name="TIPOFICIO" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
	TT.OFICIO,
	PAR.DESCR,
	TT.RAMO,
	TT.PARTIDA,
	SUM(TT.IMPTE) AS IMPORTE,
	SUM(CASE WHEN (TT.IMPTE <0) THEN TT.IMPTE ELSE 0 END) AS IMPTE_NEGATIVO,
	SUM(CASE WHEN (TT.IMPTE >0) THEN TT.IMPTE ELSE 0 END) AS IMPTE_POSITIVO,
	PARAMETROS.GOBIERNO,
	PARAMETROS.SECRETARIA,
	MOVS.STATUS,
	PARAMETROS.LOGO,
	NVL((SELECT SUM(P.ASIGNADO) FROM SPP.PPTO P WHERE P.YEAR = $P{YEAR} AND P.RAMO = TT.RAMO AND P.PARTIDA = TT.PARTIDA), 0) AS ASIGNADO,
	NVL(SUM(SPP.F_ACTUALIZADO_ANUAL_REP(TT.RAMO,TT.PARTIDA,MOVS.OFICIO,$P{TIPO},$P{YEAR})),0) AS ANUAL

FROM
	POA.MOVOFICIOS MOVS,
	SPP.VW_TRANF TT,
	DGI.PARTIDA PAR,
	DGI.PARAMETROS

WHERE
	MOVS.OFICIO = $P{OFICIO} AND
	MOVS.TIPOMOV = $P{TIPO} AND
	TT.OFICIO = MOVS.OFICIO AND
	PAR.PARTIDA = TT.PARTIDA AND
	PAR.YEAR = $P{YEAR}

GROUP BY
	TT.OFICIO,
	PAR.DESCR,
	TT.RAMO,
	TT.PARTIDA,
	PARAMETROS.GOBIERNO,
	PARAMETROS.SECRETARIA,
	MOVS.STATUS,
	PARAMETROS.LOGO]]>
	</queryString>
	<field name="OFICIO" class="java.math.BigDecimal"/>
	<field name="DESCR" class="java.lang.String"/>
	<field name="RAMO" class="java.lang.String"/>
	<field name="PARTIDA" class="java.lang.String"/>
	<field name="IMPORTE" class="java.math.BigDecimal"/>
	<field name="IMPTE_NEGATIVO" class="java.math.BigDecimal"/>
	<field name="IMPTE_POSITIVO" class="java.math.BigDecimal"/>
	<field name="GOBIERNO" class="java.lang.String"/>
	<field name="SECRETARIA" class="java.lang.String"/>
	<field name="STATUS" class="java.lang.String"/>
	<field name="LOGO" class="java.lang.String"/>
	<field name="ASIGNADO" class="java.math.BigDecimal"/>
	<field name="ANUAL" class="java.math.BigDecimal"/>
	<variable name="Negativos" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{IMPTE_NEGATIVO}]]></variableExpression>
	</variable>
	<variable name="POSITIVO" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{IMPTE_POSITIVO}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="21">
			<elementGroup>
				<staticText>
					<reportElement uuid="25327883-92bb-46f3-a0fc-80f4af1550c1" x="2" y="0" width="31" height="19"/>
					<textElement/>
					<text><![CDATA[Ramo]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<staticText>
					<reportElement uuid="ee58c706-551b-4325-9ae1-bc00872ae907" x="91" y="1" width="161" height="18"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Descripción de la Partida]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<staticText>
					<reportElement uuid="2559e57d-17d2-47f7-96a7-31a44d5bc9d4" x="252" y="1" width="132" height="18"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Presupuesto Asignado Ley]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<staticText>
					<reportElement uuid="7112e647-85c9-4e2f-b5e3-5dfe63254b53" x="384" y="0" width="107" height="18"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Movtos.Realizados]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<staticText>
					<reportElement uuid="fa5377eb-6b6f-4235-8ae1-84c5133c1e13" x="491" y="0" width="36" height="18"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[%]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<staticText>
					<reportElement uuid="eceb3dc4-88be-4c51-9b98-a0aabc27adf0" x="528" y="1" width="91" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Reducción Importe
]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<staticText>
					<reportElement uuid="f451e2a0-11b7-4bda-a74b-dd839c3263c8" x="619" y="1" width="100" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Aumento Importe]]></text>
				</staticText>
			</elementGroup>
			<staticText>
				<reportElement uuid="67cda184-4c56-4eda-8dc3-c11e62ae2071" x="33" y="1" width="58" height="20"/>
				<textElement/>
				<text><![CDATA[Partida]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="16">
			<textField>
				<reportElement uuid="b8b22ea8-e07b-47ee-8bba-066e06b5d6ba" x="91" y="0" width="161" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCR}]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;">
				<reportElement uuid="9ce0557b-bcab-4407-b942-a64f6ee76487" x="384" y="0" width="107" height="15"/>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ANUAL}]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;">
				<reportElement uuid="e05212d0-2789-44a0-a466-b957439f3b4e" x="252" y="0" width="132" height="15"/>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ASIGNADO}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00 %;(#,##0.00 %)">
				<reportElement uuid="e71ab02c-ce80-40d6-8160-60270e481ba4" x="491" y="0" width="37" height="15">
					<printWhenExpression><![CDATA[new Boolean ($F{ANUAL} > 0.00)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[(($F{ANUAL} != 0 && $F{ASIGNADO} !=0)  ? (( $F{ANUAL} / $F{ASIGNADO} )).abs()   : 0)]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;">
				<reportElement uuid="16e0c732-79cd-4fce-9c2d-ce5fe2a93d54" x="528" y="0" width="91" height="15">
					<printWhenExpression><![CDATA[new Boolean ($F{IMPTE_NEGATIVO} < 0.00)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{IMPTE_NEGATIVO}]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;">
				<reportElement uuid="638031f7-5a79-47c8-a427-8a4a0bcc1a4a" x="620" y="0" width="99" height="15">
					<printWhenExpression><![CDATA[new Boolean ($F{IMPTE_POSITIVO} >= 0.00)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{IMPTE_POSITIVO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="33d98196-9127-4aa3-9ec8-62c069745675" x="0" y="0" width="33" height="15"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{RAMO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="f1de25fd-5fc0-435e-9fb7-baac1072b449" x="33" y="0" width="58" height="15"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{PARTIDA}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
