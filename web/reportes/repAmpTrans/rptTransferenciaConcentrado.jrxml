<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptTransferenciaConcentrado" language="groovy" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d08c2163-aa59-4226-a299-145bee118e5f">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="3"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Table Dataset 1" uuid="f35a429f-5fca-46f3-9a38-51cb2470a5e1"/>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="OFICIO" class="java.lang.String"/>
	<parameter name="TIPO" class="java.lang.String"/>
	<parameter name="YEAR" class="java.lang.String"/>
	<parameter name="TIPOFICIO" class="java.lang.String"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\desarrollo\\repositorio_local\\poaUltimaVersion\\trunk\\web\\reportes\\repAmpTrans\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="RPT_DIR" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
	TT.OFICIO,
	PAR.DESCR,
	TT.RAMO,
	TT.PARTIDA,
	SUM(TT.IMPTE) AS IMPORTE,
	SUM(CASE WHEN (TT.IMPTE <0) THEN TT.IMPTE ELSE 0 END) AS IMPTE_NEGATIVO,
	SUM(CASE WHEN (TT.IMPTE >0) THEN TT.IMPTE ELSE 0 END) AS IMPTE_POSITIVO,
	PARAMETROS.GOBIERNO,
	PARAMETROS.SECRETARIA,
	MOVS.STATUS,
	PARAMETROS.LOGO,
	NVL((SELECT SUM(P.ASIGNADO) FROM SPP.PPTO P WHERE P.YEAR = $P{YEAR} AND P.RAMO = TT.RAMO AND P.PARTIDA = TT.PARTIDA), 0) AS ASIGNADO,
	NVL(SUM(SPP.F_ACTUALIZADO_ANUAL_REP(TT.RAMO,TT.PARTIDA,MOVS.OFICIO,$P{TIPOFICIO},$P{YEAR})),0) AS ANUAL

FROM
	POA.MOVOFICIOS MOVS,
	SPP.VW_TRANF_REPORTES TT,
	DGI.PARTIDA PAR,
	DGI.PARAMETROS,
          DGI.OFICONS CONS
WHERE
	MOVS.OFICIO = $P{OFICIO} AND
	MOVS.TIPOMOV =$P{TIPO}  AND
	TT.OFICIO = MOVS.OFICIO AND
	PAR.PARTIDA = TT.PARTIDA AND
     CONS.OFICIO=MOVS.OFICIO AND
          CONS.CONSEC=TT.CONSEC AND
          CONS.TIPO=$P{TIPOFICIO} AND
	PAR.YEAR = $P{YEAR}

GROUP BY
	TT.OFICIO,
	PAR.DESCR,
	TT.RAMO,
	TT.PARTIDA,
	PARAMETROS.GOBIERNO,
	PARAMETROS.SECRETARIA,
	MOVS.STATUS,
	PARAMETROS.LOGO]]>
	</queryString>
	<field name="OFICIO" class="java.math.BigDecimal"/>
	<field name="DESCR" class="java.lang.String"/>
	<field name="RAMO" class="java.lang.String"/>
	<field name="PARTIDA" class="java.lang.String"/>
	<field name="IMPORTE" class="java.math.BigDecimal"/>
	<field name="IMPTE_NEGATIVO" class="java.math.BigDecimal"/>
	<field name="IMPTE_POSITIVO" class="java.math.BigDecimal"/>
	<field name="GOBIERNO" class="java.lang.String"/>
	<field name="SECRETARIA" class="java.lang.String"/>
	<field name="STATUS" class="java.lang.String"/>
	<field name="LOGO" class="java.lang.String"/>
	<field name="ASIGNADO" class="java.math.BigDecimal"/>
	<field name="ANUAL" class="java.math.BigDecimal"/>
	<sortField name="RAMO"/>
	<sortField name="PARTIDA"/>
	<variable name="Negativos" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{IMPTE_NEGATIVO}]]></variableExpression>
	</variable>
	<variable name="POSITIVO" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{IMPTE_POSITIVO}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="163">
			<textField>
				<reportElement uuid="78c2c8d1-f827-4cf8-96ca-fe2f225b94b2" x="175" y="0" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GOBIERNO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="5f5a910b-9768-44bf-99aa-6d087bb1b1d8" x="175" y="20" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SECRETARIA}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="3b651214-d8a4-4f8f-8268-693f81bc0d29" x="1" y="161" width="750" height="1"/>
			</line>
			<image hAlign="Center" vAlign="Middle">
				<reportElement uuid="58b6077c-f671-48f9-994e-61f8b829195c" stretchType="RelativeToBandHeight" x="0" y="0" width="67" height="56"/>
				<imageExpression><![CDATA[$P{IMG_DIR}+"EDO.gif"]]></imageExpression>
			</image>
			<textField>
				<reportElement uuid="1f4fb5ae-1cde-4230-b305-7072b94562f6" x="175" y="63" width="429" height="20">
					<printWhenExpression><![CDATA[new Boolean (!($F{STATUS}.equals('A')))]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["<SIN AFECTACION AL PRESUPUESTO>"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="2b0edaf8-614a-48e4-80f5-d545ca81f1bf" x="175" y="83" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Tipo de Movimiento 'T'"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="1b5cb975-d6f8-46a0-a4dc-9cb5a02fe8c4" x="175" y="103" width="429" height="20">
					<printWhenExpression><![CDATA[new Boolean (($F{STATUS}.equals('C') || $F{STATUS}.equals('R')||$F{STATUS}.equals('M') ))]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["<FOLIO CANCELADO>"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="0e950660-c529-41af-9057-71827657369f" x="2" y="103" width="173" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["FOLIO #" + $F{OFICIO}]]></textFieldExpression>
			</textField>
			<elementGroup>
				<rectangle>
					<reportElement uuid="47ccb59e-dfcd-4537-9f8c-914d0655931e" x="1" y="124" width="51" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="25327883-92bb-46f3-a0fc-80f4af1550c1" x="2" y="124" width="49" height="38"/>
					<textElement/>
					<text><![CDATA[Partida
Ptal.
RA-PAR]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<rectangle>
					<reportElement uuid="6257b10d-fc03-4ad3-b972-a1310546e0bb" x="52" y="124" width="337" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="ee58c706-551b-4325-9ae1-bc00872ae907" x="52" y="125" width="330" height="37"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Descripción de la Partida]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<rectangle>
					<reportElement uuid="6cb63163-f212-4db0-bb03-8a2f55c6dadb" x="382" y="124" width="96" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="2559e57d-17d2-47f7-96a7-31a44d5bc9d4" x="382" y="125" width="96" height="36"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Presupuesto
Asignado Ley]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<rectangle>
					<reportElement uuid="bf02cf2b-9c69-4097-aa2e-19dc137945c7" x="478" y="124" width="66" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="7112e647-85c9-4e2f-b5e3-5dfe63254b53" x="478" y="125" width="66" height="35"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Movtos.
Realizados]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<rectangle>
					<reportElement uuid="c4bd379b-ac06-4a51-9e28-c75ff1715b1f" x="544" y="124" width="44" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="fa5377eb-6b6f-4235-8ae1-84c5133c1e13" x="544" y="124" width="44" height="38"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[%]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<rectangle>
					<reportElement uuid="8ac1a08c-2336-41fb-98e2-dc8f7e7c0013" x="588" y="124" width="81" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="eceb3dc4-88be-4c51-9b98-a0aabc27adf0" x="588" y="124" width="81" height="37"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Reducción
Importe
]]></text>
				</staticText>
			</elementGroup>
			<elementGroup>
				<rectangle>
					<reportElement uuid="a1d1a9b6-6da0-40b0-92be-e53abe55f12e" x="669" y="124" width="82" height="38"/>
				</rectangle>
				<staticText>
					<reportElement uuid="f451e2a0-11b7-4bda-a74b-dd839c3263c8" x="669" y="123" width="63" height="38"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[Aumento Importe]]></text>
				</staticText>
			</elementGroup>
			<textField>
				<reportElement uuid="55b5dce0-20f7-42de-a94f-0dbee1100194" x="175" y="40" width="429" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($P{TIPOFICIO}.equals('A')?"Solicitud de Autorización":($P{TIPOFICIO}.equals('V')?"Aviso de Modificación":($P{TIPOFICIO}.equals('U')?"Solicitud Movimientos Automaticos":"")))]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="15">
			<textField>
				<reportElement uuid="c8b11625-2932-4fd0-8cf9-3386da69c2ef" x="2" y="0" width="51" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{RAMO} + "-" + $F{PARTIDA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b8b22ea8-e07b-47ee-8bba-066e06b5d6ba" x="53" y="0" width="330" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCR}]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;" isBlankWhenNull="true">
				<reportElement uuid="e05212d0-2789-44a0-a466-b957439f3b4e" x="382" y="0" width="95" height="15"/>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ASIGNADO}]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;" isBlankWhenNull="true">
				<reportElement uuid="16e0c732-79cd-4fce-9c2d-ce5fe2a93d54" x="589" y="0" width="81" height="15">
					<printWhenExpression><![CDATA[new Boolean ($F{IMPORTE} < 0.00)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{IMPTE_NEGATIVO}]]></textFieldExpression>
			</textField>
			<textField pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;" isBlankWhenNull="true">
				<reportElement uuid="638031f7-5a79-47c8-a427-8a4a0bcc1a4a" x="670" y="0" width="81" height="15">
					<printWhenExpression><![CDATA[new Boolean ($F{IMPORTE} >= 0.00)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" markup="styled">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{IMPTE_POSITIVO}]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement uuid="e1c248ad-6bc0-4ec2-aa01-fa563fb4ec9d" x="478" y="0" width="110" height="15"/>
				<subreportParameter name="OFICIO">
					<subreportParameterExpression><![CDATA[$F{OFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="PARTIDA">
					<subreportParameterExpression><![CDATA[$F{PARTIDA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="YEAR">
					<subreportParameterExpression><![CDATA[$P{YEAR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TIPOFICIO">
					<subreportParameterExpression><![CDATA[$P{TIPOFICIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="RAMO">
					<subreportParameterExpression><![CDATA[$F{RAMO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ASIGNADO">
					<subreportParameterExpression><![CDATA[$F{ASIGNADO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{RPT_DIR} + "subRptActualizadoAnual.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<pageFooter>
		<band height="52" splitType="Stretch">
			<line>
				<reportElement uuid="14384326-65ae-4666-91b9-2e968419c11a" x="1" y="2" width="752" height="1"/>
			</line>
			<textField evaluationTime="Report">
				<reportElement uuid="3b02f55a-e207-4cfa-8950-d2096a25a095" x="701" y="41" width="31" height="10"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[" de " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="8dbb6c57-25ff-4cac-aebe-f8eaa0af6c0f" x="658" y="41" width="43" height="10"/>
				<textElement textAlignment="Right">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="76c669b9-f019-41a6-ab9c-0777c5fec37e" x="1" y="41" width="146" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["rptTransferenciaConcentrado"]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="f268e53d-217c-4286-a0e9-271659397c18" x="315" y="39" width="128" height="12"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="955717fe-7444-4327-8813-8e1407f78890" x="64" y="5" width="562" height="34"/>
				<textElement/>
				<text><![CDATA[TIPOS DE MOVIMIENTO:
              T) TRANSFERENCIA,             A)AMPLIACIÓN

]]></text>
			</staticText>
		</band>
	</pageFooter>
	<summary>
		<band height="17">
			<textField evaluationTime="Report" pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;" isBlankWhenNull="false">
				<reportElement uuid="f1749689-aa81-42e7-a05b-eec346b9ea5f" x="670" y="0" width="81" height="15"/>
				<textElement textAlignment="Right" markup="styled">
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{POSITIVO}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="2a476d88-f434-4caf-b5e3-0909034f38ac" x="523" y="0" width="66" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
			<textField evaluationTime="Report" pattern="&lt;style forecolor=&quot;black&quot;&gt;¤#,##0.00&lt;/style&gt;;&lt;style forecolor=&quot;red&quot;&gt;¤(#,##0.00)&lt;/style&gt;">
				<reportElement uuid="f47992eb-5ec9-4d05-b9f0-1ab889e4effe" x="589" y="0" width="81" height="15"/>
				<textElement textAlignment="Right" markup="styled">
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{Negativos}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
