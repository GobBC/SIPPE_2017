<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptProyectoActividadRamoPrograma" language="groovy" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a89524e2-618a-4b8b-b71b-7d8c1e4ca7a8">
	<property name="ireport.zoom" value="1.9487171000000039"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="82"/>
	<parameter name="YEAR_CAPTURA" class="java.lang.Integer"/>
	<parameter name="IN_CAPSULE" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="QUERY" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
	RAMPRG.RAMO,
	RAM.DESCR RAMO_DESCR,
	RAMPRG.PRG,
	PRG.DESCR PROGRAMA_DESCR,
	RAMPRG.DEPTO,
	PROY.PROY,
	PROY.TIPO_PROY,
	PROY.DEPTO,
	VWSPPROYACT.DESCR PROYECTO_DESCR,
	PARAM.GOBIERNO,
	PARAM.SECRETARIA,
	SYSDATE AS HOY

FROM
	POA.RAMO_PROGRAMA RAMPRG,
	DGI.RAMOS RAM,
	S_POA_PROGRAMA PRG,
	POA.PROYECTO PROY,
	DGI.PARAMETROS PARAM,
	DGI.VW_SP_PROY_ACT VWSPPROYACT

WHERE
	( RAMPRG.YEAR = $P{YEAR_CAPTURA} ) AND
	( RAM.YEAR = RAMPRG.YEAR ) AND
	( RAM.RAMO = RAMPRG.RAMO ) AND
	( PRG.YEAR = RAMPRG.YEAR ) AND
	( PRG.PRG = RAMPRG.PRG ) AND
	( PROY.RAMO(+) = RAMPRG.RAMO ) AND
	( PROY.YEAR(+) = RAMPRG.YEAR ) AND
	( PROY.PRG(+) = RAMPRG.PRG ) AND
	( PROY.TIPO_PROY  IN($P!{IN_CAPSULE}) OR PROY.TIPO_PROY IS NULL ) AND
	( VWSPPROYACT.TIPO_PROY = PROY.TIPO_PROY ) AND
	( VWSPPROYACT.PROY = PROY.PROY ) AND
	( VWSPPROYACT.YEAR = PROY.YEAR )
$P!{QUERY}
]]>
	</queryString>
	<field name="RAMO" class="java.lang.String"/>
	<field name="RAMO_DESCR" class="java.lang.String"/>
	<field name="PRG" class="java.lang.String"/>
	<field name="PROGRAMA_DESCR" class="java.lang.String"/>
	<field name="DEPTO" class="java.lang.String"/>
	<field name="PROY" class="java.math.BigDecimal"/>
	<field name="TIPO_PROY" class="java.lang.String"/>
	<field name="PROYECTO_DESCR" class="java.lang.String"/>
	<field name="GOBIERNO" class="java.lang.String"/>
	<field name="SECRETARIA" class="java.lang.String"/>
	<field name="HOY" class="java.sql.Timestamp"/>
	<group name="ramo" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{RAMO}]]></groupExpression>
		<groupHeader>
			<band height="12">
				<textField isBlankWhenNull="true">
					<reportElement uuid="34b2d1c3-8280-4b6c-9f57-2503fa4848f8" x="0" y="0" width="558" height="12"/>
					<textElement verticalAlignment="Middle">
						<font fontName="SansSerif" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{RAMO} + "-" + $F{RAMO_DESCR}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Programa" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{PRG}]]></groupExpression>
		<groupHeader>
			<band height="15">
				<textField isBlankWhenNull="true">
					<reportElement uuid="ef20523f-c783-4f5d-949d-13c6804958c1" x="15" y="2" width="542" height="12"/>
					<textElement>
						<font fontName="SansSerif" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{PRG} + "-" + $F{PROGRAMA_DESCR}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="ProyectoActividad">
		<groupExpression><![CDATA[$F{TIPO_PROY}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band height="15">
				<textField>
					<reportElement uuid="79b65b37-c446-4c91-9a61-48a29c5637ed" x="15" y="0" width="286" height="15"/>
					<textElement>
						<font fontName="SansSerif" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{TIPO_PROY} == "A"?
    "Total de Actividades por Programa " + $F{PRG}+ ": " + $V{ProyectoActividad_COUNT} :
     $F{TIPO_PROY} == "P"?
        "Total de Proyectos por Programa " + $F{PRG}+ ": " + $V{ProyectoActividad_COUNT}  :
        ""]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="TIPO_PROY">
		<groupExpression><![CDATA[$F{TIPO_PROY}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="107">
			<textField>
				<reportElement uuid="8b1bb6f8-6a1b-4a59-94be-d8200204cb77" x="0" y="40" width="752" height="20"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression><![CDATA[$P{IN_CAPSULE} == "'A','P'"?
    "REPORTE DE PROYECTOS / ACTIVIDADES POR RAMO - PROGRAMA AL " + $P{YEAR_CAPTURA} :
    $P{IN_CAPSULE} == "'A'"?
        "REPORTE DE ACTIVIDADES POR RAMO - PROGRAMA AL " + $P{YEAR_CAPTURA} :
        $P{IN_CAPSULE} == "'P'"?
            "REPORTE DE PROYECTOS POR RAMO - PROGRAMA AL " + $P{YEAR_CAPTURA} :
            ""]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="a60bf77f-b837-4a2a-8e77-b073092824e4" x="0" y="20" width="752" height="20"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SECRETARIA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="72e73dbb-b75d-4df7-b449-ddc672b9594c" x="0" y="0" width="752" height="20"/>
				<textElement textAlignment="Center">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GOBIERNO}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="83ac839b-41bc-48e4-afac-3ceaa5da70c9" x="1" y="60" width="34" height="15"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Ramo]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="8d14f74c-8828-4cef-87cb-fd7cec0d0720" x="15" y="75" width="51" height="15"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Programa]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="422691ae-fb79-480b-b738-5c91c86ce3fa" x="35" y="90" width="98" height="15"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Proyecto / Actividad]]></text>
			</staticText>
			<line>
				<reportElement uuid="a6da6f81-d9a6-4ea2-a5d1-5c6a58bcf1ae" x="0" y="105" width="751" height="1"/>
			</line>
			<image hAlign="Center" vAlign="Middle">
				<reportElement uuid="db3976dd-292f-4204-80e6-200bfb7176ae" stretchType="RelativeToBandHeight" x="0" y="0" width="66" height="59"/>
				<imageExpression><![CDATA[$P{IMG_DIR}+"EDO.gif"]]></imageExpression>
			</image>
		</band>
	</pageHeader>
	<detail>
		<band height="12">
			<textField isBlankWhenNull="true">
				<reportElement uuid="91b0adc3-f006-4c40-8cb4-484b549a3445" x="35" y="-2" width="587" height="12"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PROY} + "" + $F{TIPO_PROY} + "-" + $F{PROYECTO_DESCR}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="11" splitType="Stretch">
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="9f193cbf-f4f6-4fec-ae9f-da433084666f" x="300" y="1" width="146" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{HOY}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="55657e43-4a2a-4cea-977c-eaf1a221401a" x="0" y="0" width="752" height="1"/>
			</line>
			<textField>
				<reportElement uuid="0a693d0b-5a53-41dc-ab79-ca7e70f4735b" x="677" y="0" width="43" height="10"/>
				<textElement textAlignment="Right">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["PÃ¡gina "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="96caeec8-1aba-4a91-95d9-2ad6915df398" x="720" y="0" width="31" height="10"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[" de " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement uuid="2e9d0fc7-9bb9-42ae-8abc-9743fff2279f" x="0" y="0" width="146" height="10"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["rptProyectoActividadRamoPrograma"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
