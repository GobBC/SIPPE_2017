<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptRecalendarizacionFormatoRevisionDescrMov" language="groovy" pageWidth="751" pageHeight="71" orientation="Landscape" columnWidth="751" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="d08c2163-aa59-4226-a299-145bee118e5f">
	<property name="ireport.zoom" value="1.5000000000000075"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="IMG_DIR" class="java.lang.String"/>
	<parameter name="OFICIO" class="java.lang.Long">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="YEAR" class="java.lang.String"/>
	<parameter name="RAMO" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="RPT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["C:\\desarrollo\\repositorio_local\\POA\\web\\reportes\\RecalendarizacionFormatoRevision\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="RPT_DIR_1" class="java.lang.String">
		<defaultValueExpression><![CDATA["C:\\desarrollo\\repositorio_local\\POA\\web\\reportes\\RecalendarizacionFormatoRevision\\"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
		MOVS.OFICIO,
		MOVS.FECHAELAB,
		MOVS.APP_LOGIN,
		MOVS.TIPOMOV,
		MOVS.STATUS,
		MOVS.FECPPTO,
		MOVS.JUSTIFICACION,
		MOVS.OBS_RECHAZO,
		MOVS.CAPTURA_ESPECIAL,
		RAM.RAMO,
		RAM.DESCR RAMO_DESCR,
		FIRMLIST.FIRMA1,
		FIRMLIST.FIRMA2,
		FIRMLIST.FIRMA3,
		(
			SELECT
				nvl(count(*),0)
			FROM
				POA.MOVOFICIOS_ACCION_REQ MOVACCREQ
			WHERE
				MOVACCREQ.YEAR = $P{YEAR} AND
				MOVACCREQ.OFICIO = $P{OFICIO} AND
				MOVACCREQ.RAMO = $P{RAMO}
		) REGISTROS
	FROM
		POA.MOVOFICIOS MOVS,
		DGI.RAMOS RAM,
		(
			SELECT
				(
					SELECT
						F1.NOMBRE FIRMA1
					FROM
						(
							SELECT
								ROWNUM RN,
								USR.AP_PATER||' '||USR.AP_MATER||' '||USR.NOMBRE NOMBRE
							FROM
								POA.BITMOVTOS BMOVS,
								DGI.DGI_USR USR
							WHERE
								BMOVS.OFICIO = $P{OFICIO} AND
								BMOVS.AUTORIZO = 'A' AND
								BMOVS.TIPO_FLUJO = 2 AND
								USR.APP_LOGIN = BMOVS.APP_LOGIN AND
								USR.SYS_CLAVE = 1 AND
								USR.STATUS = 'A'
						) F1
					WHERE
						F1.RN = 1
				) FIRMA1,
				(
					SELECT
						F2.NOMBRE FIRMA2
					FROM
						(
							SELECT
								ROWNUM RN,
								USR.AP_PATER||' '||USR.AP_MATER||' '||USR.NOMBRE NOMBRE
							FROM
								POA.BITMOVTOS BMOVS,
								DGI.DGI_USR USR
							WHERE
								BMOVS.OFICIO = $P{OFICIO} AND
								BMOVS.AUTORIZO = 'A' AND
								BMOVS.TIPO_FLUJO = 2 AND
								USR.APP_LOGIN = BMOVS.APP_LOGIN AND
								USR.SYS_CLAVE = 1 AND
								USR.STATUS = 'A'
						) F2
					WHERE
						F2.RN = 2
				) FIRMA2,
				(
					SELECT
						NVL(F3.NOMBRE,' ') FIRMA3
					FROM
						(
							SELECT
								ROWNUM RN,
								DECODE(USR.AP_PATER,'',' ',USR.AP_PATER) NOMBRE
							FROM
								POA.BITMOVTOS BMOVS,
								DGI.DGI_USR USR
							WHERE
								BMOVS.OFICIO = $P{OFICIO} AND
								BMOVS.AUTORIZO = 'A' AND
								BMOVS.TIPO_FLUJO = 3 AND
								USR.APP_LOGIN (+)= BMOVS.APP_LOGIN AND
								USR.SYS_CLAVE = 1 AND
								USR.STATUS = 'A'
						) F3
					WHERE
						F3.RN = 1
				) FIRMA3
			FROM
				SYS.DUAL
		) FIRMLIST
WHERE
	MOVS.OFICIO = $P{OFICIO} AND
	MOVS.TIPOMOV = 'C' AND
	RAM.YEAR = $P{YEAR} AND
	RAM.RAMO = $P{RAMO}]]>
	</queryString>
	<field name="OFICIO" class="java.math.BigDecimal"/>
	<field name="FECHAELAB" class="java.sql.Timestamp"/>
	<field name="APP_LOGIN" class="java.lang.String"/>
	<field name="TIPOMOV" class="java.lang.String"/>
	<field name="STATUS" class="java.lang.String"/>
	<field name="FECPPTO" class="java.sql.Timestamp"/>
	<field name="JUSTIFICACION" class="oracle.sql.CLOB"/>
	<field name="OBS_RECHAZO" class="java.lang.String"/>
	<field name="CAPTURA_ESPECIAL" class="java.lang.String"/>
	<field name="RAMO" class="java.lang.String"/>
	<field name="RAMO_DESCR" class="java.lang.String"/>
	<field name="FIRMA1" class="java.lang.String"/>
	<field name="FIRMA2" class="java.lang.String"/>
	<field name="FIRMA3" class="java.lang.String"/>
	<field name="REGISTROS" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<detail>
		<band height="71">
			<rectangle>
				<reportElement uuid="7f9aa382-0fe1-42f6-91ee-d100d2ef8e64" x="0" y="0" width="751" height="71"/>
			</rectangle>
			<staticText>
				<reportElement uuid="8ccdf662-081e-4ed3-9e74-9636a3ad15e2" x="2" y="0" width="31" height="10"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[FOLIO:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="ca8f2f7b-7a49-4211-9981-940dc3b0d3d1" x="33" y="0" width="59" height="10"/>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{OFICIO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="7990c207-127e-4051-a0f4-8cf43050519b" x="132" y="0" width="617" height="10"/>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{RAMO}+" - "+$F{RAMO_DESCR}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="a6057e77-d997-45ab-885c-252ad5874731" x="92" y="0" width="40" height="10"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[RAMO:]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="e8b631a8-e024-4194-a9cb-3c79afb78e3b" x="2" y="10" width="747" height="10"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHAS DEL PROCESO DE AUTORIZACIÓN:]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="ceba75d6-a871-4353-8dc9-9a7a67ead9fa" x="2" y="20" width="90" height="10"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[ENVIO A AUTORIZACIÓN:]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="920812a6-f7b2-4a3d-b4b0-b6fa42e91897" x="132" y="20" width="114" height="10" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[!$F{FIRMA1}.equals(null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[AUTORIZADO JEFE DEL DEPTO:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="2e5b12b8-d6a6-42be-8762-25c1be0d06a9" x="92" y="20" width="40" height="10"/>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy").format($F{FECHAELAB})]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="6c406575-f42c-45f1-ae93-4e97a972fca6" x="246" y="20" width="120" height="10" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[!$F{FIRMA1}.equals(null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FIRMA1}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="92e922c2-40c6-4b4b-96a5-e5527092fbbd" x="366" y="20" width="93" height="10" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[!$F{FIRMA2}.equals(null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[AUTORIZADO DIRECCIÓN:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="5687e1e6-fc34-4153-a00b-dbb738e0e5ab" x="459" y="20" width="120" height="10" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[!$F{FIRMA2}.equals(null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FIRMA2}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="68988f4a-b196-4379-ae27-bad4804730e8" x="579" y="20" width="52" height="10" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[!$F{FIRMA3}.equals(null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[AUTORIZADO:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="29d31612-152d-4992-9666-e62289461bd1" x="631" y="20" width="118" height="10" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[!$F{FIRMA3}.equals(null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FIRMA3}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="dbda502c-fc47-4dc4-b372-8885da1d0a35" x="0" y="30" width="751" height="1"/>
			</line>
			<staticText>
				<reportElement uuid="6973f9db-e954-41de-81f8-8137041a3e15" x="2" y="31" width="181" height="10"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[NÚMERO DE REGISTROS QUE INCLUYEN EL FOLIO:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="dfde840e-df3e-404b-bf63-6b2b646b91e4" mode="Transparent" x="183" y="31" width="39" height="10"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="SansSerif" size="6" isUnderline="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{REGISTROS}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="f5ef3812-67a2-442e-98e7-09fafea226a7" mode="Opaque" x="2" y="41" width="747" height="10" backcolor="#CCCCCC"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[JUSTIFICACIÓN:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="4ae1880a-be9c-4b0c-a0f3-e4aed4fbb310" x="2" y="51" width="747" height="20"/>
				<textElement>
					<font fontName="SansSerif" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{JUSTIFICACION}.getSubString( (long)1, (int)$F{JUSTIFICACION}.length() )]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
